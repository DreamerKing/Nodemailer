<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Nodemailer by andris9</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/main.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>

      <header>
        <h1>Nodemailer</h1>
        <p>Send e-mails from Node.js – easy as cake!</p>
      </header>

      <div id="banner">
        <span id="logo"></span>

        <a href="https://github.com/andris9/Nodemailer" class="button fork"><strong>View On GitHub</strong></a>
        <div class="downloads">
          <span>Downloads:</span>
          <ul>
            <li><a href="https://github.com/andris9/Nodemailer/zipball/master" class="button">ZIP</a></li>
            <li><a href="https://github.com/andris9/Nodemailer/tarball/master" class="button">TAR</a></li>
          </ul>
        </div>
        <script type="text/javascript"><!--
    google_ad_client = "ca-pub-7677294784429110";
    /* 728x90, created 11/8/10 */
    google_ad_slot = "3636140900";
    google_ad_width = 728;
    google_ad_height = 90;
    //-->
    </script>
    <script type="text/javascript"
    src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
</script>
      </div><!-- end banner -->
    <div class="wrapper">
      <nav>
        <ul></ul>
      </nav>
      <section>
        <p><img src="https://raw2.github.com/andris9/Nodemailer/master/assets/nm_logo_200x136.png" alt="Nodemailer"></p>

<p>Send e-mails from Node.js – easy as cake!</p>

<p><a href="http://travis-ci.org/andris9/Nodemailer"><img src="https://secure.travis-ci.org/andris9/Nodemailer.svg" alt="Build Status"></a>
<a href="http://badge.fury.io/js/nodemailer"><img src="https://badge.fury.io/js/nodemailer.svg" alt="NPM version" height="18"></a></p>

<h2>
<a name="upgrade-warning" class="anchor" href="#upgrade-warning"><span class="octicon octicon-link"></span></a>Upgrade warning</h2>

<p>Do not upgrade Nodemailer from 0.7 or lower to 1.0 as there are breaking changes. You can continue to use the 0.7 branch as long as you like. See the documentation for 0.7 <a href="https://github.com/andris9/Nodemailer/blob/0.7/README.md">here</a>.</p>

<h3>
<a name="migration-guide" class="anchor" href="#migration-guide"><span class="octicon octicon-link"></span></a>Migration guide</h3>

<p>See the migration guide from 0.7 to 1.0 <a href="http://www.andrisreinman.com/nodemailer-v1-0/#migrationguide">in the 1.0 release blog post</a>.</p>

<h2>
<a name="notes-and-information" class="anchor" href="#notes-and-information"><span class="octicon octicon-link"></span></a>Notes and information</h2>

<h3>
<a name="nodemailer-supports" class="anchor" href="#nodemailer-supports"><span class="octicon octicon-link"></span></a>Nodemailer supports</h3>

<ul>
<li>
<strong>Unicode</strong> to use any characters</li>
<li>
<strong>Windows</strong> – you can install it with <em>npm</em> on Windows just like any other module, there are no compiled dependencies. Use it from Azure or from your Windows box hassle free.</li>
<li>
<strong>HTML content</strong> as well as <strong>plain text</strong> alternative</li>
<li>
<strong>Attachments</strong> (including attachment <strong>streaming</strong> for sending larger files)</li>
<li>
<strong>Embedded images</strong> in HTML</li>
<li>Secure e-mail delivery using <strong>SSL/STARTTLS</strong>
</li>
<li>Different <strong>transport methods</strong>, either using built in transports or from external plugins</li>
<li>Custom <strong>Plugin support</strong> for manipulating messages (add DKIM signatures, use markdown content instead of HTML etc.)</li>
<li>Sane <strong>XOAUTH2</strong> login with automatic access token generation (and feedback about the updated tokens)</li>
</ul><h3>
<a name="support-nodemailer-development" class="anchor" href="#support-nodemailer-development"><span class="octicon octicon-link"></span></a>Support Nodemailer development</h3>

<p><a href="https://www.paypal.com/cgi-bin/webscr?cmd=_s-xclick&amp;hosted_button_id=DB26KWR2BQX5W"><img src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_SM.gif" alt="Donate to author"></a></p>

<p>If you want to support with Bitcoins, then my wallet address is <code>15Z8ADxhssKUiwP3jbbqJwA21744KMCfTM</code></p>

<h2>
<a name="tldr-usage-example" class="anchor" href="#tldr-usage-example"><span class="octicon octicon-link"></span></a>TL;DR Usage Example</h2>

<p>This is a complete example to send an e-mail with plaintext and HTML body</p>

<div class="highlight highlight-javascript"><pre><span class="kd">var</span> <span class="nx">nodemailer</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'nodemailer'</span><span class="p">);</span>

<span class="c1">// create reusable transporter object using SMTP transport</span>
<span class="kd">var</span> <span class="nx">transporter</span> <span class="o">=</span> <span class="nx">nodemailer</span><span class="p">.</span><span class="nx">createTransport</span><span class="p">({</span>
    <span class="nx">service</span><span class="o">:</span> <span class="s1">'Gmail'</span><span class="p">,</span>
    <span class="nx">auth</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">user</span><span class="o">:</span> <span class="s1">'gmail.user@gmail.com'</span><span class="p">,</span>
        <span class="nx">pass</span><span class="o">:</span> <span class="s1">'userpass'</span>
    <span class="p">}</span>
<span class="p">});</span>

<span class="c1">// NB! No need to recreate the transporter object. You can use</span>
<span class="c1">// the same transporter object for all e-mails</span>

<span class="c1">// setup e-mail data with unicode symbols</span>
<span class="kd">var</span> <span class="nx">mailOptions</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">from</span><span class="o">:</span> <span class="s1">'Fred Foo ✔ &lt;foo@blurdybloop.com&gt;'</span><span class="p">,</span> <span class="c1">// sender address</span>
    <span class="nx">to</span><span class="o">:</span> <span class="s1">'bar@blurdybloop.com, baz@blurdybloop.com'</span><span class="p">,</span> <span class="c1">// list of receivers</span>
    <span class="nx">subject</span><span class="o">:</span> <span class="s1">'Hello ✔'</span><span class="p">,</span> <span class="c1">// Subject line</span>
    <span class="nx">text</span><span class="o">:</span> <span class="s1">'Hello world ✔'</span><span class="p">,</span> <span class="c1">// plaintext body</span>
    <span class="nx">html</span><span class="o">:</span> <span class="s1">'&lt;b&gt;Hello world ✔&lt;/b&gt;'</span> <span class="c1">// html body</span>
<span class="p">};</span>

<span class="c1">// send mail with defined transport object</span>
<span class="nx">transporter</span><span class="p">.</span><span class="nx">sendMail</span><span class="p">(</span><span class="nx">mailOptions</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">error</span><span class="p">,</span> <span class="nx">info</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="nx">error</span><span class="p">){</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">error</span><span class="p">);</span>
    <span class="p">}</span><span class="k">else</span><span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Message sent: '</span> <span class="o">+</span> <span class="nx">info</span><span class="p">.</span><span class="nx">response</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre></div>

<p>See <a href="https://github.com/andris9/nodemailer-smtp-transport#usage">nodemailer-smtp-transport</a> for SMTP configuration options and <a href="https://github.com/andris9/nodemailer-wellknown#supported-services">nodemailer-wellknown</a> for preconfigured service names (example uses 'gmail').</p>

<blockquote>
<p>When using default SMTP transport, then you do not need to define transport type explicitly (even though you can), just provide the SMTP options and that's it. For anything else, see the docs of the particular <a href="#available-transports">transport mechanism</a>.</p>
</blockquote>

<h2>
<a name="goals-for-10" class="anchor" href="#goals-for-10"><span class="octicon octicon-link"></span></a>Goals for 1.0</h2>

<h3>
<a name="1-move-optional-features-out-of-core" class="anchor" href="#1-move-optional-features-out-of-core"><span class="octicon octicon-link"></span></a>1. Move optional features out of core</h3>

<p>Nodemailer 0.x is quite large and includes a ton of stuff that is not needed for most users. Sometimes it causes problems, for example when
a feature that you do not even use requires some dependency to be installed that throws in your environment. If you only use SMTP to send e-mails you do not need the SES code and vice versa. The goal is achieved with a plugin system where you can install and load only these plugins that you actually require.</p>

<h3>
<a name="2-gigabyte-attachments" class="anchor" href="#2-gigabyte-attachments"><span class="octicon octicon-link"></span></a>2. Gigabyte attachments</h3>

<p>Version 1.0 is a total rewrite from the ground up and relying heavily on Streams2. This allows you to reliably
send messages with gigabyte attachments even through a slow network connection without CPU or memory penalties. You probably never need it but it makes using smaller attachments more reliable as well.</p>

<h2>
<a name="setting-up" class="anchor" href="#setting-up"><span class="octicon octicon-link"></span></a>Setting up</h2>

<p>Install with npm (version 1.0 can be installed from the beta channel)</p>

<pre><code>npm install nodemailer@beta
</code></pre>

<p>To send e-mails you need a transporter object</p>

<div class="highlight highlight-javascript"><pre><span class="kd">var</span> <span class="nx">transporter</span> <span class="o">=</span> <span class="nx">nodemailer</span><span class="p">.</span><span class="nx">createTransport</span><span class="p">(</span><span class="nx">transport</span><span class="p">)</span>
</pre></div>

<p>Where</p>

<ul>
<li>
<strong>transporter</strong> is going to be an object that is able to send mail</li>
<li>
<strong>transport</strong> is a transport mechanism. If it is not set <a href="https://github.com/andris9/nodemailer-direct-transport">nodemailer-direct-transport</a> transport is used. If it is a regular object <a href="https://github.com/andris9/nodemailer-smtp-transport">nodemailer-smtp-transport</a> is used and the value is passed as SMTP configuration.</li>
</ul><blockquote>
<p>You have to create the transporter object only once. If you already have a transporter object you can use it to send mail as much as you like.</p>
</blockquote>

<h3>
<a name="examples" class="anchor" href="#examples"><span class="octicon octicon-link"></span></a>Examples</h3>

<h4>
<a name="use-direct-transport" class="anchor" href="#use-direct-transport"><span class="octicon octicon-link"></span></a>Use <em>direct</em> transport</h4>

<p>In this case all e-mails are sent directly to the recipients MX server (using port 25)</p>

<div class="highlight highlight-javascript"><pre><span class="kd">var</span> <span class="nx">nodemailer</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'nodemailer'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">transporter</span> <span class="o">=</span> <span class="nx">nodemailer</span><span class="p">.</span><span class="nx">createTransport</span><span class="p">();</span>
<span class="nx">transporter</span><span class="p">.</span><span class="nx">sendMail</span><span class="p">({</span>
    <span class="nx">from</span><span class="o">:</span> <span class="s1">'sender@address'</span><span class="p">,</span>
    <span class="nx">to</span><span class="o">:</span> <span class="s1">'receiver@address'</span><span class="p">,</span>
    <span class="nx">subject</span><span class="o">:</span> <span class="s1">'hello'</span><span class="p">,</span>
    <span class="nx">text</span><span class="o">:</span> <span class="s1">'hello world!'</span>
<span class="p">});</span>
</pre></div>

<blockquote>
<p>Using <em>direct</em> transport is not reliable as outgoing port 25 used is often blocked by default. Additionally mail sent from dynamic addresses is often flagged as spam. You should really consider using a SMTP provider.</p>
</blockquote>

<h4>
<a name="use-the-default-smtp-transport" class="anchor" href="#use-the-default-smtp-transport"><span class="octicon octicon-link"></span></a>Use the default <em>SMTP</em> transport</h4>

<p>See SMTP <a href="https://github.com/andris9/nodemailer-smtp-transport#usage">configuration options here</a></p>

<div class="highlight highlight-javascript"><pre><span class="kd">var</span> <span class="nx">nodemailer</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'nodemailer'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">transporter</span> <span class="o">=</span> <span class="nx">nodemailer</span><span class="p">.</span><span class="nx">createTransport</span><span class="p">({</span>
    <span class="nx">service</span><span class="o">:</span> <span class="s1">'gmail'</span><span class="p">,</span>
    <span class="nx">auth</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">user</span><span class="o">:</span> <span class="s1">'sender@gmail.com'</span><span class="p">,</span>
        <span class="nx">pass</span><span class="o">:</span> <span class="s1">'password'</span>
    <span class="p">}</span>
<span class="p">});</span>
<span class="nx">transporter</span><span class="p">.</span><span class="nx">sendMail</span><span class="p">({</span>
    <span class="nx">from</span><span class="o">:</span> <span class="s1">'sender@address'</span><span class="p">,</span>
    <span class="nx">to</span><span class="o">:</span> <span class="s1">'receiver@address'</span><span class="p">,</span>
    <span class="nx">subject</span><span class="o">:</span> <span class="s1">'hello'</span><span class="p">,</span>
    <span class="nx">text</span><span class="o">:</span> <span class="s1">'hello world!'</span>
<span class="p">});</span>
</pre></div>

<blockquote>
<p>Default SMTP transport is not suitable for large volume of e-mails as a new SMTP connection is established for every mail sent. Use <a href="https://github.com/andris9/nodemailer-smtp-pool">nodemailer-smtp-pool</a> if you need to send a large amout of e-mails.</p>
</blockquote>

<h4>
<a name="use-a-transport-plugin" class="anchor" href="#use-a-transport-plugin"><span class="octicon octicon-link"></span></a>Use a transport plugin</h4>

<p>See <a href="#available-transports">Available Transports</a> for known transport plugins but there might be non listed polugins as well.</p>

<p>The following example uses <a href="https://github.com/andris9/nodemailer-ses-transport">nodemailer-ses-transport</a> (Amazon SES).</p>

<div class="highlight highlight-javascript"><pre><span class="kd">var</span> <span class="nx">nodemailer</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'nodemailer'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">ses</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'nodemailer-ses-transport'</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">transporter</span> <span class="o">=</span> <span class="nx">nodemailer</span><span class="p">.</span><span class="nx">createTransport</span><span class="p">(</span><span class="nx">ses</span><span class="p">({</span>
    <span class="nx">accessKeyId</span><span class="o">:</span> <span class="s1">'AWSACCESSKEY'</span><span class="p">,</span>
    <span class="nx">secretAccessKey</span><span class="o">:</span> <span class="s1">'AWS/Secret/key'</span>
<span class="p">}));</span>
<span class="nx">transporter</span><span class="p">.</span><span class="nx">sendMail</span><span class="p">({</span>
    <span class="nx">from</span><span class="o">:</span> <span class="s1">'sender@address'</span><span class="p">,</span>
    <span class="nx">to</span><span class="o">:</span> <span class="s1">'receiver@address'</span><span class="p">,</span>
    <span class="nx">subject</span><span class="o">:</span> <span class="s1">'hello'</span><span class="p">,</span>
    <span class="nx">text</span><span class="o">:</span> <span class="s1">'hello world!'</span>
<span class="p">});</span>
</pre></div>

<h2>
<a name="available-transports" class="anchor" href="#available-transports"><span class="octicon octicon-link"></span></a>Available Transports</h2>

<p><strong>Built in</strong></p>

<ul>
<li>
<strong><a href="https://github.com/andris9/nodemailer-smtp-transport">nodemailer-smtp-transport</a></strong> for sending messages using a SMTP service</li>
<li>
<strong><a href="https://github.com/andris9/nodemailer-direct-transport">nodemailer-direct-transport</a></strong> for sending messages directly to recipients MX servers (zero configuration needed but unreliable)</li>
</ul><p><strong>Install as dependencies</strong></p>

<ul>
<li>
<strong><a href="https://github.com/andris9/nodemailer-smtp-pool">nodemailer-smtp-pool</a></strong> for sending messages to SMTP using pooled connections</li>
<li>
<strong><a href="https://github.com/andris9/nodemailer-ses-transport">nodemailer-ses-transport</a></strong> for sending messages to AWS SES</li>
<li>
<strong><a href="https://github.com/andris9/nodemailer-sendmail-transport">nodemailer-sendmail-transport</a></strong> for piping messages to the <em>sendmail</em> command</li>
<li>
<strong><a href="https://github.com/andris9/nodemailer-stub-transport">nodemailer-stub-transport</a></strong> is just for returning messages, most probably for testing purposes</li>
<li>
<strong><a href="https://github.com/andris9/nodemailer-pickup-transport">nodemailer-pickup-transport</a></strong> for storing messages to pickup folders</li>
<li>
<em>add yours</em> (see transport api documentation <a href="#transports">here</a>)</li>
</ul><h2>
<a name="available-plugins" class="anchor" href="#available-plugins"><span class="octicon octicon-link"></span></a>Available Plugins</h2>

<ul>
<li>
<strong><a href="https://github.com/andris9/nodemailer-markdown">nodemailer-markdown</a></strong> to use markdown for the content</li>
<li>
<strong><a href="https://github.com/andris9/nodemailer-dkim">nodemailer-dkim</a></strong> to sign messages with DKIM</li>
<li>
<em>add yours</em> (see plugin api documentation <a href="#plugin-api">here</a>)</li>
</ul><h2>
<a name="sending-mail" class="anchor" href="#sending-mail"><span class="octicon octicon-link"></span></a>Sending mail</h2>

<p>Once you have a transporter object you can send mail</p>

<div class="highlight highlight-javascript"><pre><span class="nx">transporter</span><span class="p">.</span><span class="nx">sendMail</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">callback</span><span class="p">)</span>
</pre></div>

<p>Where</p>

<ul>
<li>
<strong>data</strong> defines the mail content (see <a href="#e-mail-message-fields">e-mail message fields</a> below)</li>
<li>
<strong>callback</strong> is an optional callback function to run once the message is delivered or it failed.

<ul>
<li>
<strong>err</strong> is the error object if message failed</li>
<li>
<strong>info</strong> includes the result, the exact format depends on the transport mechanism used

<ul>
<li>
<strong>info.messageId</strong> most transports <em>should</em> return the final Message-Id value used with this property</li>
<li>
<strong>info.envelope</strong> includes the envelope object for the message</li>
<li>
<strong>info.accepted</strong> is an array returend by SMTP transports (includes recipient addresses that were accepted by the server)</li>
<li>
<strong>info.rejected</strong> is an array returend by SMTP transports (includes recipient addresses that were rejected by the server)</li>
<li>
<strong>info.pending</strong> is an array returend by Direct SMTP transport. Includes recipient addresses that were temporarily rejected together with the server response</li>
<li>
<strong>response</strong> is a string returned by SMTP transports and includes the last SMTP response from the server</li>
</ul>
</li>
</ul>
</li>
</ul><blockquote>
<p>If the message includes several recipients then the message is considered sent if at least one recipient is accepted</p>
</blockquote>

<h3>
<a name="e-mail-message-fields" class="anchor" href="#e-mail-message-fields"><span class="octicon octicon-link"></span></a>E-mail message fields</h3>

<p>The following are the possible fields of an e-mail message:</p>

<ul>
<li>
<strong>from</strong> - The e-mail address of the sender. All e-mail addresses can be plain <code>'sender@server.com'</code> or formatted <code>'Sender Name &lt;sender@server.com&gt;'</code>, see <a href="#address-formatting">here</a> for details</li>
<li>
<strong>to</strong> - Comma separated list or an array of recipients e-mail addresses that will appear on the <em>To:</em> field</li>
<li>
<strong>cc</strong> - Comma separated list or an array of recipients e-mail addresses that will appear on the <em>Cc:</em> field</li>
<li>
<strong>bcc</strong> - Comma separated list or an array of recipients e-mail addresses that will appear on the <em>Bcc:</em> field</li>
<li>
<strong>replyTo</strong> - An e-mail address that will appear on the <em>Reply-To:</em> field</li>
<li>
<strong>inReplyTo</strong> - The message-id this message is replying</li>
<li>
<strong>references</strong> - Message-id list (an array or space separated string)</li>
<li>
<strong>subject</strong> - The subject of the e-mail</li>
<li>
<strong>text</strong> - The plaintext version of the message as an Unicode string, Buffer, Stream or an object <em>{path: '...'}</em>
</li>
<li>
<strong>html</strong> - The HTML version of the message as an Unicode string, Buffer, Stream or an object <em>{path: '...'}</em>
</li>
<li>
<strong>headers</strong> - An object of additional header fields <em>{"X-Key-Name": "key value"}</em>
</li>
<li>
<strong>attachments</strong> - An array of attachment objects  (see <a href="#attachments">below</a> for details)</li>
<li>
<strong>alternatives</strong> - An array of alternative text contents (in addition to text and html parts)  (see <a href="#alternatives">below</a> for details)</li>
<li>
<strong>envelope</strong> - optional SMTP envelope, if auto generated envelope is not suitable (see <a href="#smtp-envelope">below</a> for details)</li>
<li>
<strong>messageId</strong> - optional Message-Id value, random value will be generated if not set</li>
<li>
<strong>date</strong> - optional Date value, current UTC string will be used if not set</li>
<li>
<strong>encoding</strong> - optional transfer encoding for the textual parts (defaults to 'quoted-printable')</li>
</ul><p>All text fields (e-mail addresses, plaintext body, html body) use UTF-8 as the encoding.
Attachments are streamed as binary.</p>

<h3>
<a name="attachments" class="anchor" href="#attachments"><span class="octicon octicon-link"></span></a>Attachments</h3>

<p>Attachment object consists of the following properties:</p>

<ul>
<li>
<strong>filename</strong> - filename to be reported as the name of the attached file, use of unicode is allowed</li>
<li>
<strong>cid</strong> - optional content id for using inline images in HTML message source</li>
<li>
<strong>content</strong> - String, Buffer or a Stream contents for the attachment</li>
<li>
<strong>path</strong> - path to a file or an URL if you want to stream the file instead of including it (better for larger attachments)</li>
<li>
<strong>contentType</strong> - optional content type for the attachment, if not set will be derived from the <code>filename</code> property</li>
<li>
<strong>contentDisposition</strong> - optional content disposition type for the attachment, defaults to 'attachment'</li>
</ul><p>Attachments can be added as many as you want.</p>

<div class="highlight highlight-javascript"><pre><span class="kd">var</span> <span class="nx">mailOptions</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">...</span>
    <span class="nx">attachments</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span>   <span class="c1">// utf-8 string as an attachment</span>
            <span class="nx">filename</span><span class="o">:</span> <span class="s1">'text1.txt'</span><span class="p">,</span>
            <span class="nx">content</span><span class="o">:</span> <span class="s1">'hello world!'</span>
        <span class="p">},</span>
        <span class="p">{</span>   <span class="c1">// binary buffer as an attachment</span>
            <span class="nx">filename</span><span class="o">:</span> <span class="s1">'text2.txt'</span><span class="p">,</span>
            <span class="nx">content</span><span class="o">:</span> <span class="k">new</span> <span class="nx">Buffer</span><span class="p">(</span><span class="s1">'hello world!'</span><span class="p">,</span><span class="s1">'utf-8'</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="p">{</span>   <span class="c1">// file on disk as an attachment</span>
            <span class="nx">filename</span><span class="o">:</span> <span class="s1">'text3.txt'</span><span class="p">,</span>
            <span class="nx">path</span><span class="o">:</span> <span class="s1">'/path/to/file.txt'</span> <span class="c1">// stream this file</span>
        <span class="p">},</span>
        <span class="p">{</span>   <span class="c1">// filename and content type is derived from path</span>
            <span class="nx">path</span><span class="o">:</span> <span class="s1">'/path/to/file.txt'</span>
        <span class="p">},</span>
        <span class="p">{</span>   <span class="c1">// stream as an attachment</span>
            <span class="nx">filename</span><span class="o">:</span> <span class="s1">'text4.txt'</span><span class="p">,</span>
            <span class="nx">content</span><span class="o">:</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">createReadStream</span><span class="p">(</span><span class="s1">'file.txt'</span><span class="p">)</span>
        <span class="p">},</span>
        <span class="p">{</span>   <span class="c1">// define custom content type for the attachment</span>
            <span class="nx">filename</span><span class="o">:</span> <span class="s1">'text.bin'</span><span class="p">,</span>
            <span class="nx">content</span><span class="o">:</span> <span class="s1">'hello world!'</span><span class="p">,</span>
            <span class="nx">contentType</span><span class="o">:</span> <span class="s1">'text/plain'</span>
        <span class="p">},</span>
        <span class="p">{</span>   <span class="c1">// use URL as an attachment</span>
            <span class="nx">filename</span><span class="o">:</span> <span class="s1">'license.txt'</span><span class="p">,</span>
            <span class="nx">path</span><span class="o">:</span> <span class="s1">'https://raw.github.com/andris9/Nodemailer/master/LICENSE'</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>

<h3>
<a name="alternatives" class="anchor" href="#alternatives"><span class="octicon octicon-link"></span></a>Alternatives</h3>

<p>In addition to text and HTML, any kind of data can be inserted as an alternative content of the main body - for example a word processing document with the same text as in the HTML field. It is the job of the e-mail client to select and show the best fitting alternative to the reader. Usually this field is used for calendar events and such.</p>

<p>Alternative objects use the same options as <a href="#attachments">attachment objects</a>. The difference between an attachment and an alternative is the fact that attachments are placed into <em>multipart/mixed</em> or <em>multipart/related</em> parts of the message white alternatives are placed into <em>multipart/alternative</em> part.</p>

<p><strong>Usage example:</strong></p>

<div class="highlight highlight-javascript"><pre><span class="kd">var</span> <span class="nx">mailOptions</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">...</span>
    <span class="nx">html</span><span class="o">:</span> <span class="s1">'&lt;b&gt;Hello world!&lt;/b&gt;'</span><span class="p">,</span>
    <span class="nx">alternatives</span><span class="o">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="nx">contentType</span><span class="o">:</span> <span class="s1">'text/x-web-markdown'</span><span class="p">,</span>
            <span class="nx">content</span><span class="o">:</span> <span class="s1">'**Hello world!**'</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>

<p>Alternatives can be added as many as you want.</p>

<h3>
<a name="address-formatting" class="anchor" href="#address-formatting"><span class="octicon octicon-link"></span></a>Address Formatting</h3>

<p>All the e-mail addresses can be plain e-mail addresses</p>

<pre><code>foobar@blurdybloop.com
</code></pre>

<p>or with formatted name (includes unicode support)</p>

<pre><code>"Ноде Майлер" &lt;foobar@blurdybloop.com&gt;
</code></pre>

<p>or as an address object</p>

<pre><code>{
    name: 'Ноде Майлер',
    address: 'foobar@blurdybloop.com'
}
</code></pre>

<p>To, Cc and Bcc fields accept comma separated list of e-mails or an array of
e-mails or an array of comma separated list of e-mails - use it as you like.
Formatting can be mixed.</p>

<pre><code>...,
to: 'foobar@blurdybloop.com, "Ноде Майлер" &lt;bar@blurdybloop.com&gt;, "Name, User" &lt;baz@blurdybloop.com&gt;',
cc: ['foobar@blurdybloop.com', '"Ноде Майлер" &lt;bar@blurdybloop.com&gt;, "Name, User" &lt;baz@blurdybloop.com&gt;']
...
</code></pre>

<p>You can even use unicode domains, these are automatically converted to punycode</p>

<pre><code>'"Unicode Domain" &lt;info@müriaad-polüteism.info&gt;'
</code></pre>

<h3>
<a name="smtp-envelope" class="anchor" href="#smtp-envelope"><span class="octicon octicon-link"></span></a>SMTP envelope</h3>

<p>SMTP envelope is usually auto generated from <code>from</code>, <code>to</code>, <code>cc</code> and <code>bcc</code> fields but
if for some reason you want to specify it yourself, you can do it with <code>envelope</code> property.</p>

<p><code>envelope</code> is an object with the following params: <code>from</code>, <code>to</code>, <code>cc</code> and <code>bcc</code> just like
with regular mail options. You can also use the regular address format, unicode domains etc.</p>

<div class="highlight highlight-javascript"><pre><span class="nx">mailOptions</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">...,</span>
    <span class="nx">from</span><span class="o">:</span> <span class="s1">'mailer@kreata.ee'</span><span class="p">,</span>
    <span class="nx">to</span><span class="o">:</span> <span class="s1">'daemon@kreata.ee'</span><span class="p">,</span>
    <span class="nx">envelope</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">from</span><span class="o">:</span> <span class="s1">'Daemon &lt;deamon@kreata.ee&gt;'</span><span class="p">,</span>
        <span class="nx">to</span><span class="o">:</span> <span class="s1">'mailer@kreata.ee, Mailer &lt;mailer2@kreata.ee&gt;'</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

<blockquote>
<p>Not all transports can use the <code>envelope</code> object, for example SES ignores it and uses the data from the From:, To: etc. headers.</p>
</blockquote>

<h3>
<a name="using-embedded-images" class="anchor" href="#using-embedded-images"><span class="octicon octicon-link"></span></a>Using Embedded Images</h3>

<p>Attachments can be used as embedded images in the HTML body. To use this feature, you need to set additional property of the attachment - <code>cid</code> (unique identifier of the file) which is a reference to the attachment file. The same <code>cid</code> value must be used as the image URL in HTML (using <code>cid:</code> as the URL protocol, see example below).</p>

<p><strong>NB!</strong> the cid value should be as unique as possible!</p>

<div class="highlight highlight-javascript"><pre><span class="kd">var</span> <span class="nx">mailOptions</span> <span class="o">=</span> <span class="p">{</span>
    <span class="p">...</span>
    <span class="nx">html</span><span class="o">:</span> <span class="s1">'Embedded image: &lt;img src="cid:unique@kreata.ee"/&gt;'</span><span class="p">,</span>
    <span class="nx">attachments</span><span class="o">:</span> <span class="p">[{</span>
        <span class="nx">filename</span><span class="o">:</span> <span class="s1">'image.png'</span><span class="p">,</span>
        <span class="nx">path</span><span class="o">:</span> <span class="s1">'/path/to/file'</span><span class="p">,</span>
        <span class="nx">cid</span><span class="o">:</span> <span class="s1">'unique@kreata.ee'</span> <span class="c1">//same cid value as in the html img src</span>
    <span class="p">}]</span>
<span class="p">}</span>
</pre></div>

<h2>
<a name="plugin-system" class="anchor" href="#plugin-system"><span class="octicon octicon-link"></span></a>Plugin system</h2>

<p>There are 3 stages a plugin can hook to</p>

<ol>
<li>
<strong>'compile'</strong> is the step where e-mail data is set but nothing has been done with it yet. At this step you can modify mail options, for example modify <code>html</code> content, add new headers etc. Example: <a href="https://github.com/andris9/nodemailer-markdown">nodemailer-markdown</a> that allows you to use <code>markdown</code> source instead of <code>text</code> and <code>html</code>.</li>
<li>
<strong>'stream'</strong> is the step where message tree has been compiled and is ready to be streamed. At this step you can modify the generated MIME tree or add a transform stream that the generated raw e-mail will be piped through before passed to the transport object. Example: <a href="https://github.com/andris9/nodemailer-dkim">nodemailer-dkim</a> that adds DKIM signature to the generated message.</li>
<li>
<strong>Transport</strong> step where the raw e-mail is streamed to destination. Example: <a href="https://github.com/andris9/nodemailer-smtp-transport">nodemailer-smtp-transport</a> that streams the message to a SMTP server.</li>
</ol><h3>
<a name="including-plugins" class="anchor" href="#including-plugins"><span class="octicon octicon-link"></span></a>Including plugins</h3>

<p>'compile' and 'stream' plugins can be attached with <code>use(plugin)</code> method</p>

<div class="highlight highlight-javascript"><pre><span class="nx">transporter</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">step</span><span class="p">,</span> <span class="nx">pluginFunc</span><span class="p">)</span>
</pre></div>

<p>Where</p>

<ul>
<li>
<strong>transporter</strong> is a transport object created with <code>createTransport</code>
</li>
<li>
<strong>step</strong> is a string, either 'compile' or 'stream' thatd defines when the plugin should be hooked</li>
<li>
<strong>pluginFunc</strong> is a function that takes two arguments: the mail object and a callback function</li>
</ul><h2>
<a name="plugin-api" class="anchor" href="#plugin-api"><span class="octicon octicon-link"></span></a>Plugin API</h2>

<p>All plugins (including transports) get two arguments, the mail object and a callback function.</p>

<p>Mail object that is passed to the plugin function as the first argument is an object with the following properties:</p>

<ul>
<li>
<strong>data</strong> is the mail data object that is passed to the <code>sendMail</code> method</li>
<li>
<strong>message</strong> is the <a href="https://github.com/andris9/buildmail">BuildMail</a> object of the message. This is available for the 'stream' step and for the transport but not for 'compile'.</li>
</ul><h3>
<a name="compile" class="anchor" href="#compile"><span class="octicon octicon-link"></span></a>'compile'</h3>

<p>Compile step plugins get only the <code>mail.data</code> object but not <code>mail.message</code> in the <code>mail</code> argument of the plugin function. If you need to access the <code>mail.message</code> as well use 'stream' step instead.</p>

<p>This is really straightforward, your plugin can modify the <code>mail.data</code> object at will and once everything is finished run the callback function. If the callback gets an error object as an argument, then the process is terminated and the error is returned to the <code>sendMail</code> callback.</p>

<p><strong>Example</strong></p>

<p>The following plugin checks if <code>text</code> value is set and if not converts <code>html</code> value to <code>text</code> by removing all html tags.</p>

<div class="highlight highlight-javascript"><pre><span class="nx">transporter</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s1">'compile'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">mail</span><span class="p">,</span> <span class="nx">callback</span><span class="p">){</span>
    <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nx">mail</span><span class="p">.</span><span class="nx">text</span> <span class="o">&amp;&amp;</span> <span class="nx">mail</span><span class="p">.</span><span class="nx">html</span><span class="p">){</span>
        <span class="nx">mail</span><span class="p">.</span><span class="nx">text</span> <span class="o">=</span> <span class="nx">mail</span><span class="p">.</span><span class="nx">html</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/&lt;[^&gt;]*&gt;/g</span><span class="p">,</span> <span class="s1">' '</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="nx">callback</span><span class="p">();</span>
<span class="p">});</span>
</pre></div>

<p>See <a href="examples/plugin-compile.js">plugin-compile.js</a> for a working example.</p>

<h3>
<a name="stream" class="anchor" href="#stream"><span class="octicon octicon-link"></span></a>'stream'</h3>

<p>Streaming step is invoked once the message structure is built and ready to be streamed to the transport. Plugin function still gets <code>mail.data</code> but it is included just for the reference, modifying it should not change anything (unless the transport requires something from the <code>mail.data</code>, for example <code>mail.data.envelope</code>).</p>

<p>You can modify the <code>mail.message</code> object as you like, the message is not yet streaming anything (message starts streaming when the transport calls <code>mail.message.createReadStream()</code>).</p>

<p>In most cases you might be interested in the <a href="https://github.com/andris9/buildmail#transform">message.transform()</a> method for applying transform streams to the raw message.</p>

<p><strong>Example</strong></p>

<p>The following plugin replaces all tabs with spaces in the raw message.</p>

<div class="highlight highlight-javascript"><pre><span class="kd">var</span> <span class="nx">transformer</span> <span class="o">=</span> <span class="k">new</span> <span class="p">(</span><span class="nx">require</span><span class="p">(</span><span class="s1">'stream'</span><span class="p">).</span><span class="nx">Transform</span><span class="p">)();</span>
<span class="nx">transformer</span><span class="p">.</span><span class="nx">_transform</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">chunk</span><span class="p">,</span> <span class="nx">encoding</span><span class="p">,</span> <span class="nx">done</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// replace all tabs with spaces in the stream chunk</span>
    <span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">chunk</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="nx">chunk</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">===</span> <span class="mh">0x09</span><span class="p">){</span>
            <span class="nx">chunk</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">=</span> <span class="mh">0x20</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
    <span class="k">this</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="nx">chunk</span><span class="p">);</span>
    <span class="nx">done</span><span class="p">();</span>
<span class="p">};</span>

<span class="nx">transporter</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="s1">'stream'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">mail</span><span class="p">,</span> <span class="nx">callback</span><span class="p">){</span>
    <span class="c1">// apply output transformer to the raw message stream</span>
    <span class="nx">mail</span><span class="p">.</span><span class="nx">message</span><span class="p">.</span><span class="nx">transform</span><span class="p">(</span><span class="nx">transformer</span><span class="p">);</span>
    <span class="nx">callback</span><span class="p">();</span>
<span class="p">});</span>
</pre></div>

<p>See <a href="examples/plugin-stream.js">plugin-stream.js</a> for a working example.</p>

<h3>
<a name="transports" class="anchor" href="#transports"><span class="octicon octicon-link"></span></a>Transports</h3>

<p>Transports are objects that have a method <code>send</code> and properies <code>name</code> and <code>version</code>. Additionally, if the transport object is an Event Emitter, 'log' events are piped through Nodemailer. A transport object is passed to the <code>nodemailer.createTransport(transport)</code> method to create the transporter object.</p>

<p><strong><code>transport.name</code></strong></p>

<p>This is the name of the transport object. For example 'SMTP' or 'SES' etc.</p>

<div class="highlight highlight-javascript"><pre><span class="nx">transport</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'package.json'</span><span class="p">).</span><span class="nx">name</span><span class="p">;</span>
</pre></div>

<p><strong><code>transport.version</code></strong></p>

<p>This should be the transport module version. For example '0.1.0'.</p>

<div class="highlight highlight-javascript"><pre><span class="nx">transport</span><span class="p">.</span><span class="nx">version</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">'package.json'</span><span class="p">).</span><span class="nx">version</span><span class="p">;</span>
</pre></div>

<p><strong><code>transport.send(mail, callback)</code></strong></p>

<p>This is the method that actually sends out e-mails. The method is basically the same as 'stream' plugin functions. It gets two arguments: <code>mail</code> and a callback. To start streaming the message, create the stream with <code>mail.message.createReadStream()</code></p>

<p>Callback function should return an <code>info</code> object as the second arugment. This info object should contain <code>messageId</code> value with the Message-Id header (without the surrounding &lt; &gt; brackets)</p>

<p>The following example pipes the raw stream to the console.</p>

<div class="highlight highlight-javascript"><pre><span class="nx">transport</span><span class="p">.</span><span class="nx">send</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">mail</span><span class="p">,</span> <span class="nx">callback</span><span class="p">){</span>
    <span class="kd">var</span> <span class="nx">input</span> <span class="o">=</span> <span class="nx">mail</span><span class="p">.</span><span class="nx">message</span><span class="p">.</span><span class="nx">createReadStream</span><span class="p">();</span>
    <span class="kd">var</span> <span class="nx">messageId</span> <span class="o">=</span> <span class="p">(</span><span class="nx">mail</span><span class="p">.</span><span class="nx">message</span><span class="p">.</span><span class="nx">getHeader</span><span class="p">(</span><span class="s1">'message-id'</span><span class="p">)</span> <span class="o">||</span> <span class="s1">''</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/[&lt;&gt;\s]/g</span><span class="p">,</span> <span class="s1">''</span><span class="p">);</span>
    <span class="nx">input</span><span class="p">.</span><span class="nx">pipe</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">stdout</span><span class="p">);</span>
    <span class="nx">input</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">'end'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
        <span class="nx">callback</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span> <span class="p">{</span>
            <span class="nx">messageId</span><span class="o">:</span> <span class="nx">messageId</span>
        <span class="p">});</span>
    <span class="p">});</span>
<span class="p">};</span>
</pre></div>

<p>Once you have a transport object, you can create a mail transporter out of it.</p>

<pre><code>var nodemailer = require('nodemailer');
var transport = require('some-transport-method');
var transporter = nodemailer.createTransport(transport);
transporter.sendMail({mail data});
</code></pre>

<p>See <a href="examples/minimal-transport.js">minimal-transport.js</a> for a working example.</p>

<h2>
<a name="license" class="anchor" href="#license"><span class="octicon octicon-link"></span></a>License</h2>

<p><strong>Nodemailer</strong> is licensed under <a href="https://github.com/andris9/Nodemailer/blob/master/LICENSE">MIT license</a>. Basically you can do whatever you want to with it</p>

<hr><p>The Nodemailer logo was designed by <a href="https://www.behance.net/kristjansen">Sven Kristjansen</a>.</p>
      </section>
      <footer>
        <p>Project maintained by <a href="https://github.com/andris9">andris9</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-51322-34");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>